import{n as c,o as J,r as y}from"./components-LSgrH8J_.js";import{M as e,O as S,Q as V,R as X,S as Y,U as D,V as E,W as K,X as Q,Y as W,Z,_ as A,$ as N,a0 as ee,a1 as te,a2 as ae,a3 as re,a4 as ne,a5 as oe,a6 as se}from"./index-D27P0ozE.js";import"./stripIndent-BnlsVTH3.js";var ie=Object.defineProperty,w=(t,a)=>{for(var r in a)ie(t,r,{get:a[r],enumerable:!0})};function P(t,{contentType:a,dataStreamVersion:r}){const n=new Headers(t??{});return n.has("Content-Type")||n.set("Content-Type",a),r!==void 0&&n.set("X-Vercel-AI-Data-Stream",r),n}var O="AI_NoObjectGeneratedError",k=`vercel.ai.error.${O}`,le=Symbol.for(k),F,C=class extends D{constructor({message:t="No object generated.",cause:a,text:r,response:n,usage:o}){super({name:O,message:t,cause:a}),this[F]=!0,this.text=r,this.response=n,this.usage=o}static isInstance(t){return D.hasMarker(t,k)}};F=le;var U=e.union([e.string(),e.instanceof(Uint8Array),e.instanceof(ArrayBuffer),e.custom(t=>{var a,r;return(r=(a=globalThis.Buffer)==null?void 0:a.isBuffer(t))!=null?r:!1},{message:"Must be a Buffer"})]),b=e.lazy(()=>e.union([e.null(),e.string(),e.number(),e.boolean(),e.record(e.string(),b),e.array(b)])),m=e.record(e.string(),e.record(e.string(),b)),ce=e.array(e.union([e.object({type:e.literal("text"),text:e.string()}),e.object({type:e.literal("image"),data:e.string(),mimeType:e.string().optional()})])),q=e.object({type:e.literal("text"),text:e.string(),experimental_providerMetadata:m.optional()}),ue=e.object({type:e.literal("image"),image:e.union([U,e.instanceof(URL)]),mimeType:e.string().optional(),experimental_providerMetadata:m.optional()}),de=e.object({type:e.literal("file"),data:e.union([U,e.instanceof(URL)]),mimeType:e.string(),experimental_providerMetadata:m.optional()}),me=e.object({type:e.literal("tool-call"),toolCallId:e.string(),toolName:e.string(),args:e.unknown()}),pe=e.object({type:e.literal("tool-result"),toolCallId:e.string(),toolName:e.string(),result:e.unknown(),content:ce.optional(),isError:e.boolean().optional(),experimental_providerMetadata:m.optional()}),fe=e.object({role:e.literal("system"),content:e.string(),experimental_providerMetadata:m.optional()}),ge=e.object({role:e.literal("user"),content:e.union([e.string(),e.array(e.union([q,ue,de]))]),experimental_providerMetadata:m.optional()}),he=e.object({role:e.literal("assistant"),content:e.union([e.string(),e.array(e.union([q,me]))]),experimental_providerMetadata:m.optional()}),Se=e.object({role:e.literal("tool"),content:e.array(pe),experimental_providerMetadata:m.optional()});e.union([fe,ge,he,Se]);var ve="JSON schema:",xe="You MUST answer with a JSON object that matches the JSON schema above.",ye="You MUST answer with JSON.";function be({prompt:t,schema:a,schemaPrefix:r=a!=null?ve:void 0,schemaSuffix:n=a!=null?xe:ye}){return[t!=null&&t.length>0?t:void 0,t!=null&&t.length>0?"":void 0,r,a!=null?JSON.stringify(a):void 0,n].filter(o=>o!=null).join(`
`)}S({prefix:"aiobj",size:24});S({prefix:"aiobj",size:24});S({prefix:"aitxt",size:24});var we={};w(we,{object:()=>Te,text:()=>je});var je=()=>({type:"text",responseFormat:()=>({type:"text"}),injectIntoSystemPrompt({system:t}){return t},parseOutput({text:t}){return t}}),Te=({schema:t})=>{const a=V(t);return{type:"object",responseFormat:({model:r})=>({type:"json",schema:r.supportsStructuredOutputs?a.jsonSchema:void 0}),injectIntoSystemPrompt({system:r,model:n}){return n.supportsStructuredOutputs?r:be({prompt:r,schema:a.jsonSchema})},parseOutput({text:r},n){const o=X({text:r});if(!o.success)throw new C({message:"No object generated: could not parse the response.",cause:o.error,text:r,response:n.response,usage:n.usage});const s=Y({value:o.value,schema:a});if(!s.success)throw new C({message:"No object generated: response did not match schema.",cause:s.error,text:r,response:n.response,usage:n.usage});return s.value}}};function B(t,a){const r=t.getReader(),n=a.getReader();let o,s,u=!1,p=!1;async function g(i){try{o==null&&(o=r.read());const l=await o;o=void 0,l.done?i.close():i.enqueue(l.value)}catch(l){i.error(l)}}async function h(i){try{s==null&&(s=n.read());const l=await s;s=void 0,l.done?i.close():i.enqueue(l.value)}catch(l){i.error(l)}}return new ReadableStream({async pull(i){try{if(u){await h(i);return}if(p){await g(i);return}o==null&&(o=r.read()),s==null&&(s=n.read());const{result:l,reader:v}=await Promise.race([o.then(f=>({result:f,reader:r})),s.then(f=>({result:f,reader:n}))]);l.done||i.enqueue(l.value),v===r?(o=void 0,l.done&&(await h(i),u=!0)):(s=void 0,l.done&&(p=!0,await g(i)))}catch(l){i.error(l)}},cancel(){r.cancel(),n.cancel()}})}S({prefix:"aitxt",size:24});var _e={};w(_e,{mergeIntoDataStream:()=>De,toDataStream:()=>Re,toDataStreamResponse:()=>Ie});function z(t={}){const a=new TextEncoder;let r="";return new TransformStream({async start(){t.onStart&&await t.onStart()},async transform(n,o){o.enqueue(a.encode(n)),r+=n,t.onToken&&await t.onToken(n),t.onText&&typeof n=="string"&&await t.onText(n)},async flush(){t.onCompletion&&await t.onCompletion(r),t.onFinal&&await t.onFinal(r)}})}function j(t,a){return t.pipeThrough(new TransformStream({transform:async(r,n)=>{var o;if(typeof r=="string"){n.enqueue(r);return}if("event"in r){r.event==="on_chat_model_stream"&&M((o=r.data)==null?void 0:o.chunk,n);return}M(r,n)}})).pipeThrough(z(a)).pipeThrough(new TextDecoderStream).pipeThrough(new TransformStream({transform:async(r,n)=>{n.enqueue(E("text",r))}}))}function Re(t,a){return j(t,a).pipeThrough(new TextEncoderStream)}function Ie(t,a){var r;const n=j(t,a?.callbacks).pipeThrough(new TextEncoderStream),o=a?.data,s=a?.init,u=o?B(o.stream,n):n;return new Response(u,{status:(r=s?.status)!=null?r:200,statusText:s?.statusText,headers:P(s?.headers,{contentType:"text/plain; charset=utf-8",dataStreamVersion:"v1"})})}function De(t,a){a.dataStream.merge(j(t,a.callbacks))}function M(t,a){if(typeof t.content=="string")a.enqueue(t.content);else{const r=t.content;for(const n of r)n.type==="text"&&a.enqueue(n.text)}}var Ce={};w(Ce,{mergeIntoDataStream:()=>Ae,toDataStream:()=>Me,toDataStreamResponse:()=>Ee});function T(t,a){const r=Ne();return K(t[Symbol.asyncIterator]()).pipeThrough(new TransformStream({async transform(n,o){o.enqueue(r(n.delta))}})).pipeThrough(z(a)).pipeThrough(new TextDecoderStream).pipeThrough(new TransformStream({transform:async(n,o)=>{o.enqueue(E("text",n))}}))}function Me(t,a){return T(t,a).pipeThrough(new TextEncoderStream)}function Ee(t,a={}){var r;const{init:n,data:o,callbacks:s}=a,u=T(t,s).pipeThrough(new TextEncoderStream),p=o?B(o.stream,u):u;return new Response(p,{status:(r=n?.status)!=null?r:200,statusText:n?.statusText,headers:P(n?.headers,{contentType:"text/plain; charset=utf-8",dataStreamVersion:"v1"})})}function Ae(t,a){a.dataStream.merge(T(t,a.callbacks))}function Ne(){let t=!0;return a=>(t&&(a=a.trimStart(),a&&(t=!1)),a)}const Pe=({message:t="Loading..."})=>c.jsx("div",{className:"fixed inset-0 flex items-center justify-center bg-black/80 z-50 backdrop-blur-sm",children:c.jsxs("div",{className:"relative flex flex-col items-center gap-4 p-8 rounded-lg bg-bolt-elements-background-depth-2 shadow-lg",children:[c.jsx("div",{className:"i-svg-spinners:90-ring-with-bg text-bolt-elements-loader-progress",style:{fontSize:"2rem"}}),c.jsx("p",{className:"text-lg text-bolt-elements-textTertiary",children:t})]})}),Oe=["node_modules/**",".git/**",".github/**",".vscode/**","**/*.jpg","**/*.jpeg","**/*.png","dist/**","build/**",".next/**","coverage/**",".cache/**",".vscode/**",".idea/**","**/*.log","**/.DS_Store","**/npm-debug.log*","**/yarn-debug.log*","**/yarn-error.log*","**/*lock.json","**/*lock.yaml"];function ke(){const[t]=J(),{ready:a,importChat:r}=Q(),{ready:n,gitClone:o}=W(),[s,u]=y.useState(!1),[p,g]=y.useState(!0),h=async i=>{if(!(!n&&!a)&&i){const l=te().add(Oe),{workdir:v,data:f}=await o(i);if(r){const G=Object.keys(f).filter(d=>!l.ignores(d)),L=new TextDecoder("utf-8"),_=G.map(d=>{const{data:x,encoding:H}=f[d];return{path:d,content:H==="utf8"?x:x instanceof Uint8Array?L.decode(x):""}}).filter(d=>d.content),$=await ae(_),R=re($),I=[{role:"assistant",content:`Cloning the repo ${i} into ${v}
<boltArtifact id="imported-files" title="Git Cloned Files" type="bundled">           
${_.map(d=>`<boltAction type="file" filePath="${d.path}">
${d.content}
</boltAction>`).join(`
`)}
</boltArtifact>`,id:ne(),createdAt:new Date}];R&&I.push(R),await r(`Git Project:${i.split("/").slice(-1)[0]}`,I)}}};return y.useEffect(()=>{if(!a||!n||s)return;const i=t.get("url");if(!i){window.location.href="/";return}h(i).catch(l=>{console.error("Error importing repo:",l),Z.error("Failed to import repository"),g(!1),window.location.href="/"}),u(!0)},[t,a,n,s]),c.jsx(A,{fallback:c.jsx(N,{}),children:()=>c.jsxs(c.Fragment,{children:[c.jsx(ee,{}),p&&c.jsx(Pe,{message:"Please wait while we clone the repository..."})]})})}const ze=()=>[{title:"Bolt"},{name:"description",content:"Talk with Bolt, an AI assistant from StackBlitz"}];function Ge(){return c.jsxs("div",{className:"flex flex-col h-full w-full bg-bolt-elements-background-depth-1",children:[c.jsx(oe,{}),c.jsx(se,{}),c.jsx(A,{fallback:c.jsx(N,{}),children:()=>c.jsx(ke,{})})]})}export{Ge as default,ze as meta};
